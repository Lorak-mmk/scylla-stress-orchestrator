#!/bin/python3


import sys
import os
sys.path.insert(1, f"{os.environ['SSO']}/src/")

import yaml
from sso import terraform
from sso import util

if len(sys.argv) == 1:
    print("No data directory")
    exit(1)

data_dir = sys.argv[1]
if not os.path.exists(data_dir):
    print(f"[{data_dir}] does not exist!")
    exit(1)

if not os.path.isdir(data_dir):
    print(f"[{data_dir}] is not a directory!")
    exit(1)

scylla_monitoring_path=os.environ['SCYLLA_MONITORING']

old_wd=os.getcwd()
os.chdir(scylla_monitoring_path)

util.log_important("Killing Scylla Monitoring: starting")
os.system("./kill-all.sh")
util.log_important("Killing Scylla Monitoring: done")

util.log_important("Starting Scylla Monitoring: started")
os.system(f"./start-all.sh -d {data_dir}")
util.log_important("Starting Scylla Monitoring: done")

os.chdir(old_wd)     
